# 公网访问部署指南

管理员操作，把本机知识库发布到公网，让 30 名成员都能访问。

---

## 架构

```
群成员浏览器 / Claude Code
       │ HTTPS
       ▼
Cloudflare Tunnel（免费）
       │ 本地转发
       ▼
Docsify 静态服务（本机 5000 端口）
       │ 读取文件
       ▼
D:\E_shop_ai_agent\电商知识库\
```

---

## 第一步：安装 Docsify

需要先装 [Node.js LTS](https://nodejs.org)，然后：

```bash
npm install -g docsify-cli

# 验证
docsify -v

# 启动
docsify serve D:\E_shop_ai_agent\电商知识库 --port 5000
```

浏览器打开 `http://localhost:5000` 确认本地可以访问。

---

## 第二步：安装 Cloudflare Tunnel

### 下载 cloudflared

从 GitHub Releases 下载 `cloudflared-windows-amd64.exe`，
重命名为 `cloudflared.exe`，放入 `C:\Windows\System32\`。

```bash
cloudflared --version   # 验证安装
```

### 临时公网地址（无需域名，立即可用）

```bash
cloudflared tunnel --url http://localhost:5000
```

输出类似 `https://xxxx.trycloudflare.com`，把这个地址发给群成员。
**注意：每次重启地址会变。**

### 固定域名（长期使用）

```bash
# 1. 登录 Cloudflare
cloudflared tunnel login

# 2. 创建 Tunnel
cloudflared tunnel create eshop-docs

# 3. 配置文件 C:\Users\你的用户名\.cloudflared\config.yml
tunnel: <Tunnel ID>
credentials-file: C:\Users\你的用户名\.cloudflared\<Tunnel ID>.json
ingress:
  - hostname: docs.你的域名.com
    service: http://localhost:5000
  - service: http_status:404

# 4. 绑定域名
cloudflared tunnel route dns eshop-docs docs.你的域名.com

# 5. 启动
cloudflared tunnel run eshop-docs

# 6. 开机自启（可选）
cloudflared service install
```

---

## 一键启动

双击 `D:\E_shop_ai_agent\启动服务.bat` 即可同时启动 Docsify 和 Cloudflare Tunnel。

---

## 费用

| 工具 | 费用 |
|------|------|
| Docsify | 免费 |
| Cloudflare Tunnel | 免费 |
| 域名（可选） | 约 50 元/年 |

---

*最后更新：2026-02-19*
